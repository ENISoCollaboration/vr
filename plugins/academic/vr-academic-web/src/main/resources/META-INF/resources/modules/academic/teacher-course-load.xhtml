<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this license header, choose License Headers in Project Properties.

and open the template in the editor.
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:c="http://java.sun.com/jsp/jstl/core"

>

<h:head>
</h:head>

<h:body>


    <!--@elvariable id="vr" type="net.vpc.app.vainruling.core.web.Vr"-->
    <!--@elvariable id="teacherCourseLoadCtrl" type="net.vpc.app.vainruling.plugins.academic.web.load.TeacherCourseLoadCtrl"-->

    <ui:composition template="#{vr.themePath}/templates/private-template.xhtml">
        <ui:define name="content">
            <h:form id="buttonsForm">
                <p:confirmDialog message="Are you sure, you want to delete ?" header="Initiating deleting process"
                                 widgetVar="confirmationDelete">
                    <p:commandButton value="Yes Sure" onclick="PF('confirmationDelete').hide();
                                processOnDeleteCurrent();"/>
                    <p:commandButton value="Not Yet" onclick="PF('confirmationDelete').hide()" type="button"/>
                </p:confirmDialog>

                <!-- /.row -->
                <div class="row">
                    <p:outputLabel id="buttons">
                        <p:commandButton value="Rafr." icon="ui-ribbonicon-refresh"
                                         styleClass="vr-form-field vr-form-fixed-width-medium ui-ribbon-bigbutton vr-icon-aws" ajax="true"
                                         actionListener="#{teacherCourseLoadCtrl.onRefresh}" update=":listForm"/>

                        <p:menuButton value="Actions..." style="margin-left: 10px;"
                                      rendered="#{teacherCourseLoadCtrl.model.currentTeacher ne null}"
                                      styleClass="vr-form-field vr-form-fixed-width-medium">
                            <p:menuitem value="Affectations => Voeux (tous)"
                                        disabled="#{!vr.userSession.departmentManager and !vr.userSession.admin}"
                                        actionListener="#{teacherCourseLoadCtrl.assignmentsToIntentsAll()}"
                                        update=":listForm"/>
                            <p:menuitem value="Voeux => Affectations (tous)"
                                        disabled="#{!vr.userSession.departmentManager and !vr.userSession.admin}"
                                        actionListener="#{teacherCourseLoadCtrl.intentsToAssignmentsAll()}"
                                        update=":listForm"/>
                            <p:separator/>
                            <p:menuitem
                                    value="Affectations => Voeux (#{teacherCourseLoadCtrl.model.currentTeacher})"
                                    disabled="#{!vr.userSession.departmentManager and !vr.userSession.admin}"
                                    actionListener="#{teacherCourseLoadCtrl.assignmentsToIntentsMine()}"
                                    rendered="#{teacherCourseLoadCtrl.model.currentTeacher ne null}"
                                    update=":listForm"/>
                            <p:separator/>
                            <p:menuitem
                                    disabled="#{!vr.userSession.departmentManager and !vr.userSession.admin}"
                                    value="Affecter tout (#{teacherCourseLoadCtrl.model.currentTeacher})"
                                    actionListener="#{teacherCourseLoadCtrl.intentsToAssignmentsMine()}"
                                    rendered="#{teacherCourseLoadCtrl.model.currentTeacher ne null}"
                                    update=":listForm"/>
                            <p:separator/>
                            <p:menuitem
                                    value="Supprimer Voeux (#{teacherCourseLoadCtrl.model.currentTeacher})"
                                    actionListener="#{teacherCourseLoadCtrl.removeAllIntentsMine()}"
                                    rendered="#{teacherCourseLoadCtrl.model.currentTeacher ne null}"
                                    update=":listForm"/>
                            <p:separator/>
                            <p:menuitem
                                    value="Supprimer Affectations (#{teacherCourseLoadCtrl.model.currentTeacher})"
                                    actionListener="#{teacherCourseLoadCtrl.removeAllAssignmentsMine()}"
                                    rendered="#{teacherCourseLoadCtrl.model.currentTeacher ne null}"
                                    update=":listForm"/>
                            <p:separator/>
                        </p:menuButton>
                    </p:outputLabel>
                </div>
                <p:fieldset legend="Filtres" toggleable="true" toggleSpeed="500">
                    <div>
                        <div>
                            <p:outputLabel value="Période" styleClass="vr-form-field vr-form-fixed-width-medium"/>
                            <p:selectOneMenu styleClass="vr-form-field"
                                             value="#{teacherCourseLoadCtrl.teacherFilter.model.selectedPeriod}">
                                <p:ajax listener="#{teacherCourseLoadCtrl.onChangePeriod}"
                                        update=":buttonsForm :listForm"/>
                                <f:selectItem itemLabel="Selectionner Période..." itemValue=""/>
                                <f:selectItems value="#{teacherCourseLoadCtrl.teacherFilter.model.periodItems}"/>
                            </p:selectOneMenu>
                        </div>
                        <div>
                            <p:outputLabel value="Enseignant" styleClass="vr-form-field vr-form-fixed-width-medium"/>
                            <p:selectCheckboxMenu
                                    styleClass="vr-form-field #{teacherCourseLoadCtrl.teacherFilter.model.selectedDepartments.isEmpty() ?'':'vr-selected-many-selected'}"
                                    value="#{teacherCourseLoadCtrl.teacherFilter.model.selectedDepartments}"
                                    label="Departements"
                                    filter="true" filterMatchMode="startsWith" panelStyle="width:250px">
                                <p:ajax listener="#{teacherCourseLoadCtrl.onChangeOther}"
                                        update=":listForm :buttonsForm"/>
                                <f:selectItems value="#{teacherCourseLoadCtrl.teacherFilter.model.departmentItems}"/>
                            </p:selectCheckboxMenu>

                            <p:selectCheckboxMenu
                                    styleClass="vr-form-field #{teacherCourseLoadCtrl.teacherFilter.model.selectedDegrees.isEmpty() ?'':'vr-selected-many-selected'}"
                                    value="#{teacherCourseLoadCtrl.teacherFilter.model.selectedDegrees}"
                                    label="Grades"
                                    filter="true" filterMatchMode="startsWith" panelStyle="width:250px">
                                <p:ajax listener="#{teacherCourseLoadCtrl.onChangeOther}"
                                        update=":listForm :buttonsForm"/>
                                <f:selectItems value="#{teacherCourseLoadCtrl.teacherFilter.model.degreeItems}"/>
                            </p:selectCheckboxMenu>
                            <p:selectCheckboxMenu
                                    styleClass="vr-form-field #{teacherCourseLoadCtrl.teacherFilter.model.selectedSituations.isEmpty() ?'':'vr-selected-many-selected'}"
                                    value="#{teacherCourseLoadCtrl.teacherFilter.model.selectedSituations}"
                                    label="Situations"
                                    filter="true" filterMatchMode="startsWith" panelStyle="width:250px">
                                <p:ajax listener="#{teacherCourseLoadCtrl.onChangeOther}"
                                        update=":listForm :buttonsForm"/>
                                <f:selectItems value="#{teacherCourseLoadCtrl.teacherFilter.model.situationItems}"/>
                            </p:selectCheckboxMenu>
                            <p:selectCheckboxMenu
                                    styleClass="vr-form-field #{teacherCourseLoadCtrl.teacherFilter.model.selectedOfficialDisciplines.isEmpty() ?'':'vr-selected-many-selected'}"
                                    value="#{teacherCourseLoadCtrl.teacherFilter.model.selectedOfficialDisciplines}"
                                    label="Disciplines"
                                    filter="true" filterMatchMode="startsWith" panelStyle="width:250px">
                                <p:ajax listener="#{teacherCourseLoadCtrl.onChangeOther}"
                                        update=":listForm :buttonsForm"/>
                                <f:selectItems
                                        value="#{teacherCourseLoadCtrl.teacherFilter.model.officialDisciplinesItems}"/>
                            </p:selectCheckboxMenu>
                            <p:selectOneMenu id="teachersList" styleClass="vr-form-field"
                                             value="#{teacherCourseLoadCtrl.model.teacherId}">
                                <p:ajax listener="#{teacherCourseLoadCtrl.onChangeAcademicTeacher}"
                                        update=":buttonsForm :listForm"/>
                                <f:selectItem itemLabel="Selectionner Enseignant..." itemValue=""/>
                                <f:selectItems value="#{teacherCourseLoadCtrl.model.teachers}"/>
                            </p:selectOneMenu>
                        </div>
                        <div>
                            <p:outputLabel value="Modules"
                                           styleClass="vr-form-field vr-form-fixed-width-medium vr-form-indented-child"/>
                            <div class="vr-form-sub-rows">
                                <div class="vr-form-sub-row">
                                    <p:selectCheckboxMenu
                                            styleClass="vr-form-field #{teacherCourseLoadCtrl.courseFilter.model.selectedSemesters.isEmpty() ?'':'vr-selected-many-selected'}"
                                            value="#{teacherCourseLoadCtrl.courseFilter.model.selectedSemesters}"
                                            label="Semestres"
                                            filter="true" filterMatchMode="startsWith"
                                            panelStyle="width:250px">
                                        <p:ajax listener="#{teacherCourseLoadCtrl.onRefreshFiltersChanged}"
                                                update=":listForm :buttonsForm"/>
                                        <f:selectItems
                                                value="#{teacherCourseLoadCtrl.courseFilter.model.semesterItems}"/>
                                    </p:selectCheckboxMenu>
                                    <p:selectCheckboxMenu
                                            styleClass="vr-form-field #{teacherCourseLoadCtrl.courseFilter.model.selectedProgramTypes.isEmpty() ?'':'vr-selected-many-selected'}"
                                            value="#{teacherCourseLoadCtrl.courseFilter.model.selectedProgramTypes}"
                                            label="Type Formation"
                                            filter="true" filterMatchMode="startsWith"
                                            panelStyle="width:250px">
                                        <p:ajax listener="#{teacherCourseLoadCtrl.onRefreshFiltersChanged}"
                                                update=":listForm :buttonsForm"/>
                                        <f:selectItems
                                                value="#{teacherCourseLoadCtrl.courseFilter.model.programTypeItems}"/>
                                    </p:selectCheckboxMenu>
                                    <p:selectCheckboxMenu
                                            styleClass="vr-form-field #{teacherCourseLoadCtrl.courseFilter.model.selectedCourseTypes.isEmpty() ?'':'vr-selected-many-selected'}"
                                            value="#{teacherCourseLoadCtrl.courseFilter.model.selectedCourseTypes}"
                                            label="Types Modules"
                                            filter="true" filterMatchMode="startsWith"
                                            panelStyle="width:250px">
                                        <p:ajax listener="#{teacherCourseLoadCtrl.onRefreshFiltersChanged}"
                                                update=":listForm :buttonsForm"/>
                                        <f:selectItems
                                                value="#{teacherCourseLoadCtrl.courseFilter.model.courseTypeItems}"/>
                                    </p:selectCheckboxMenu>
                                    <p:selectCheckboxMenu
                                            styleClass="vr-form-field #{teacherCourseLoadCtrl.courseFilter.model.selectedClasses.isEmpty() ?'':'vr-selected-many-selected'}"
                                            value="#{teacherCourseLoadCtrl.courseFilter.model.selectedClasses}"
                                            label="Classes"
                                            filter="true" filterMatchMode="startsWith"
                                            panelStyle="width:250px">
                                        <p:ajax listener="#{teacherCourseLoadCtrl.onRefreshFiltersChanged}"
                                                update=":listForm :buttonsForm"/>
                                        <f:selectItems value="#{teacherCourseLoadCtrl.courseFilter.model.classItems}"/>
                                    </p:selectCheckboxMenu>
                                </div>
                                <div class="vr-form-sub-row">
                                    <p:selectCheckboxMenu
                                            styleClass="vr-form-field #{teacherCourseLoadCtrl.courseFilter.model.selectedDepartments.isEmpty() ?'':'vr-selected-many-selected'}"
                                            value="#{teacherCourseLoadCtrl.courseFilter.model.selectedDepartments}"
                                            label="Departement"
                                            filter="true" filterMatchMode="startsWith"
                                            panelStyle="width:250px">
                                        <p:ajax listener="#{teacherCourseLoadCtrl.onRefreshFiltersChanged}"
                                                update=":listForm :buttonsForm"/>
                                        <f:selectItems
                                                value="#{teacherCourseLoadCtrl.courseFilter.model.departmentItems}"/>
                                    </p:selectCheckboxMenu>
                                    <p:selectCheckboxMenu
                                            styleClass="vr-form-field #{teacherCourseLoadCtrl.courseFilter.model.selectedOwnerDepartments.isEmpty() ?'':'vr-selected-many-selected'}"
                                            value="#{teacherCourseLoadCtrl.courseFilter.model.selectedOwnerDepartments}"
                                            label="Géré par..."
                                            filter="true" filterMatchMode="startsWith"
                                            panelStyle="width:250px">
                                        <p:ajax listener="#{teacherCourseLoadCtrl.onRefreshFiltersChanged}"
                                                update=":listForm :buttonsForm"/>
                                        <f:selectItems
                                                value="#{teacherCourseLoadCtrl.courseFilter.model.departmentItems}"/>
                                    </p:selectCheckboxMenu>
                                    <p:selectCheckboxMenu
                                            styleClass="vr-form-field #{teacherCourseLoadCtrl.courseFilter.model.selectedLabels.isEmpty() ?'':'vr-selected-many-selected'}"
                                            value="#{teacherCourseLoadCtrl.courseFilter.model.selectedLabels}"
                                            label="Label"
                                            filter="true" filterMatchMode="startsWith"
                                            panelStyle="width:250px">
                                        <p:ajax listener="#{teacherCourseLoadCtrl.onRefreshFiltersChanged}"
                                                update=":listForm :buttonsForm"/>
                                        <f:selectItems value="#{teacherCourseLoadCtrl.courseFilter.model.labelItems}"/>
                                    </p:selectCheckboxMenu>
                                    <p:selectCheckboxMenu
                                            styleClass="vr-form-field #{teacherCourseLoadCtrl.courseFilter.model.selectedDeviationGroups.isEmpty() ?'':'vr-selected-many-selected'}"
                                            value="#{teacherCourseLoadCtrl.courseFilter.model.selectedDeviationGroups}"
                                            label="Groupe Balance"
                                            filter="true" filterMatchMode="startsWith"
                                            panelStyle="width:250px">
                                        <p:ajax listener="#{teacherCourseLoadCtrl.onRefreshFiltersChanged}"
                                                update=":listForm :buttonsForm"/>
                                        <f:selectItems
                                                value="#{teacherCourseLoadCtrl.courseFilter.model.deviationGroupItems}"/>
                                    </p:selectCheckboxMenu>
                                </div>
                                <div class="vr-form-sub-row">
                                    <div class="table-responsive">
                                        <p:selectManyCheckbox styleClass="vr-form-field"
                                                              value="#{teacherCourseLoadCtrl.courseFilter.model.refreshFilter}"
                                                              layout="grid"
                                                              columns="5">
                                            <p:ajax listener="#{teacherCourseLoadCtrl.onRefreshFiltersChanged}"
                                                    update=":listForm"/>
                                            <f:selectItems
                                                    value="#{teacherCourseLoadCtrl.courseFilter.model.refreshFilterItems}"/>
                                        </p:selectManyCheckbox>
                                    </div>
                                </div>
                                <div class="vr-form-sub-row">
                                    <p:selectManyCheckbox styleClass="vr-form-field"
                                                          value="#{teacherCourseLoadCtrl.model.othersFilters}"
                                                          layout="grid" columns="3"

                                    >
                                        <p:ajax listener="#{teacherCourseLoadCtrl.onOthersFiltersChanged}"
                                                update=":listForm"/>
                                        <f:selectItems value="#{teacherCourseLoadCtrl.model.filterSelectItems}"/>
                                    </p:selectManyCheckbox>
                                </div>
                            </div>
                        </div>
                    </div>
                </p:fieldset>
                <div class="row" style="margin-top: 20px">
                    <div class="table-responsive">

                        <!--<p:commandButton value="Rafr." icon="ui-ribbonicon-refresh" styleClass="ui-ribbon-bigbutton vr-icon-aws" ajax="true" actionListener="# {teacherCourseLoadCtrl.onRefresh}"  update=":listForm"/>-->
                    </div>
                </div>
            </h:form>
            <h:form id="listForm">

                <div class="row">
                    <div class="table-responsive">
                        <h1>
                            <p:commandLink
                                    action="#{vr.gotoPageObjItem('AcademicTeacher',vr.str(teacherCourseLoadCtrl.model.currentTeacher.id))}"
                                    style="font-weight: bold"
                                    value="#{teacherCourseLoadCtrl.model.currentTeacher.contact.fullName} - #{teacherCourseLoadCtrl.model.stat.val.teacher.degree.name} - #{teacherCourseLoadCtrl.model.stat.val.teacher.situation.name}"/>
                        </h1>
                        <p:panelGrid>
                            <p:row>
                                <p:column styleClass="ui-widget-header"><p:outputLabel value=""/></p:column>
                                <p:column styleClass="ui-widget-header"><p:outputLabel value="Semaines"/></p:column>
                                <p:column styleClass="ui-widget-header"><p:outputLabel value="C"/></p:column>
                                <p:column styleClass="ui-widget-header"><p:outputLabel value="TD"/></p:column>
                                <p:column styleClass="ui-widget-header"><p:outputLabel value="TP"/></p:column>
                                <p:column styleClass="ui-widget-header"><p:outputLabel value="PM"/></p:column>
                                <p:column styleClass="ui-widget-header"><p:outputLabel value="TP+PM"/></p:column>
                                <p:column styleClass="ui-widget-header"><p:outputLabel value="Total Du"/></p:column>
                                <p:column styleClass="ui-widget-header"><p:outputLabel value="Total Charge"/></p:column>
                                <p:column styleClass="ui-widget-header"><p:outputLabel
                                        value="Total H.Supp."/></p:column>
                                <p:column styleClass="ui-widget-header"><p:outputLabel value="Du / Sem"/></p:column>
                                <p:column styleClass="ui-widget-header"><p:outputLabel
                                        value="Total Charge / Sem"/></p:column>
                                <p:column styleClass="ui-widget-header"><p:outputLabel
                                        value="H.Supp. / Sem"/></p:column>
                                <p:column styleClass="ui-widget-header"><p:outputLabel
                                        value="Balance"/></p:column>
                                <p:column styleClass="ui-widget-header" style="widows: 100px;"><p:outputLabel
                                        value=""/></p:column>
                            </p:row>

                            <p:row>
                                <p:column styleClass="ui-widget-header"><p:outputLabel
                                        value="Charge Annuelle"/></p:column>
                                <p:column><p:outputLabel value=""/></p:column>
                                <p:column><p:outputLabel
                                        value="#{teacherCourseLoadCtrl.model.stat.val.value.c}"><f:convertNumber
                                        pattern="#0.00"/></p:outputLabel></p:column>
                                <p:column><p:outputLabel
                                        value="#{teacherCourseLoadCtrl.model.stat.val.value.td}"><f:convertNumber
                                        pattern="#0.00"/></p:outputLabel></p:column>
                                <p:column><p:outputLabel
                                        value="#{teacherCourseLoadCtrl.model.stat.val.value.tp}"><f:convertNumber
                                        pattern="#0.00"/></p:outputLabel></p:column>
                                <p:column><p:outputLabel
                                        value="#{teacherCourseLoadCtrl.model.stat.val.value.pm}"><f:convertNumber
                                        pattern="#0.00"/></p:outputLabel></p:column>
                                <p:column><p:outputLabel
                                        value="#{teacherCourseLoadCtrl.model.stat.val.value.tppm}"><f:convertNumber
                                        pattern="#0.00"/></p:outputLabel></p:column>
                                <p:column><p:outputLabel
                                        value="#{teacherCourseLoadCtrl.model.stat.val.due.equiv}"><f:convertNumber
                                        pattern="#0.00"/></p:outputLabel></p:column>
                                <p:column><p:outputLabel
                                        value="#{teacherCourseLoadCtrl.model.stat.val.value.equiv}"><f:convertNumber
                                        pattern="#0.00"/></p:outputLabel></p:column>
                                <p:column><p:outputLabel
                                        value="#{teacherCourseLoadCtrl.model.stat.val.extra.equiv}"><f:convertNumber
                                        pattern="#0.00"/></p:outputLabel></p:column>
                                <p:column><p:outputLabel
                                        value="#{teacherCourseLoadCtrl.model.stat.val.dueWeek.equiv}"><f:convertNumber
                                        pattern="#0.00"/></p:outputLabel></p:column>
                                <p:column><p:outputLabel
                                        value="#{teacherCourseLoadCtrl.model.stat.val.valueWeek.equiv}"><f:convertNumber
                                        pattern="#0.00"/></p:outputLabel></p:column>
                                <p:column><p:outputLabel
                                        value="#{teacherCourseLoadCtrl.model.stat.val.extraWeek.equiv}"><f:convertNumber
                                        pattern="#0.00"/></p:outputLabel></p:column>
                                <p:column>
                                    <p:outputLabel
                                            value="#{teacherCourseLoadCtrl.model.stat.val.deviation}"><f:convertNumber
                                            pattern="#0.00%"/></p:outputLabel>
                                    <h:outputText value=" / #{teacherCourseLoadCtrl.model.stat.val.population.size}"/>
                                </p:column>
                                <p:column>
                                    <div class="vr-progress-container" style="width: 100%;">
                                        <div class="#{teacherCourseLoadCtrl.model.stat.val.deviationLabel}"
                                             style="width:#{vr.frame(vr.abs(teacherCourseLoadCtrl.model.stat.val.deviation),0,1)*100}%">

                                        </div>
                                    </div>
                                </p:column>
                            </p:row>
                            <c:forEach items="#{teacherCourseLoadCtrl.model.stat.semesters}" var="sem">
                                <p:row>
                                    <p:column styleClass="ui-widget-header"><p:outputLabel
                                            value="Charge #{sem.val.semester.name}"/></p:column>
                                    <p:column><p:outputLabel
                                            value="#{sem.val.weeks}"><f:convertNumber
                                            pattern="#0.#"/></p:outputLabel></p:column>
                                    <p:column><p:outputLabel
                                            value="#{sem.val.value.c}"><f:convertNumber
                                            pattern="#0.00"/></p:outputLabel></p:column>
                                    <p:column><p:outputLabel
                                            value="#{sem.val.value.td}"><f:convertNumber
                                            pattern="#0.00"/></p:outputLabel></p:column>
                                    <p:column><p:outputLabel
                                            value="#{sem.val.value.tp}"><f:convertNumber
                                            pattern="#0.00"/></p:outputLabel></p:column>
                                    <p:column><p:outputLabel
                                            value="#{sem.val.value.pm}"><f:convertNumber
                                            pattern="#0.00"/></p:outputLabel></p:column>
                                    <p:column><p:outputLabel
                                            value="#{sem.val.value.tppm}"><f:convertNumber
                                            pattern="#0.00"/></p:outputLabel></p:column>
                                    <p:column><p:outputLabel
                                            value="#{sem.val.due.equiv}"><f:convertNumber
                                            pattern="#0.00"/></p:outputLabel></p:column>
                                    <p:column><p:outputLabel
                                            value="#{sem.val.value.equiv}"><f:convertNumber
                                            pattern="#0.00"/></p:outputLabel></p:column>
                                    <p:column><p:outputLabel
                                            value="#{sem.val.extra.equiv}"><f:convertNumber
                                            pattern="#0.00"/></p:outputLabel></p:column>
                                    <p:column><p:outputLabel
                                            value="#{sem.val.dueWeek.equiv}"><f:convertNumber
                                            pattern="#0.00"/></p:outputLabel></p:column>
                                    <p:column><p:outputLabel
                                            value="#{sem.val.valueWeek.equiv}"><f:convertNumber
                                            pattern="#0.00"/></p:outputLabel></p:column>
                                    <p:column><p:outputLabel
                                            value="#{sem.val.extraWeek.equiv}"><f:convertNumber
                                            pattern="#0.00"/></p:outputLabel></p:column>
                                    <p:column>
                                        <p:outputLabel
                                                value="#{sem.val.deviation}"><f:convertNumber
                                                pattern="#0.00%"/></p:outputLabel>
                                        <h:outputText
                                                value=" / #{sem.val.population.size}"/>
                                    </p:column>
                                    <p:column>
                                        <div class="vr-progress-container" style="width: 100%;">
                                            <div class="#{sem.val.deviationLabel}"
                                                 style="width:#{vr.frame(vr.abs(sem.val.deviation),0,1)*100}%">

                                            </div>
                                        </div>
                                    </p:column>
                                </p:row>
                            </c:forEach>
                        </p:panelGrid>
                    </div>
                </div>

                <ui:repeat value="#{teacherCourseLoadCtrl.model.stat.semesters}" var="sem">
                    <div class="row">
                        <div class="table-responsive">
                            <h1>Semestre #{sem.val.semester.name}</h1>
                            <p:dataTable var="i" value="#{sem.assignments}"
                                         class="table table-bordered table-hover"
                                         paginatorAlwaysVisible="false"
                                         paginator="true"
                                         paginatorPosition="bottom"
                                         rows="20"
                                         paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                         rowsPerPageTemplate="10,20,50"
                                         emptyMessage="Aucune charge"
                            >
                                <p:column style="padding: 0;" styleClass="ui-widget-header" headerText="" width="5%">
                                    <f:facet name="header">
                                        <p:menuButton value="..."
                                                      rendered="#{teacherCourseLoadCtrl.model.enableLoadEditing and teacherCourseLoadCtrl.model.multipleSelection}"
                                        >
                                            <p:menuitem value="Aj. Voeux"
                                                        actionListener="#{teacherCourseLoadCtrl.addToMineSelected()}"
                                                        update=":listForm" icon="ui-icon-arrowrefresh-1-w"/>
                                            <p:menuitem value="Supp. Voeux"
                                                        actionListener="#{teacherCourseLoadCtrl.removeFromMineSelected()}"
                                                        update=":listForm" icon="ui-icon-close"/>
                                            <p:separator/>
                                            <p:menuitem value="Affecter"
                                                        actionListener="#{teacherCourseLoadCtrl.doAssignSelected()}"
                                                        update=":listForm" icon="ui-icon-arrowrefresh-1-w"/>
                                            <p:menuitem value="Supp. Affectation"
                                                        actionListener="#{teacherCourseLoadCtrl.doUnAssignSelected()}"
                                                        update=":listForm" icon="ui-icon-close"/>
                                        </p:menuButton>
                                    </f:facet>
                                    <p:selectBooleanCheckbox
                                            style="margin-left: 10px;"
                                            rendered="#{teacherCourseLoadCtrl.model.enableLoadEditing and teacherCourseLoadCtrl.model.multipleSelection}"
                                            actionListener="#{teacherCourseLoadCtrl.removeFromMine(i.value.assignment.id)}"
                                            value="#{i.selected}"
                                            update=":listForm" title="Clickez ici pour supprimer le voeux"/>
                                    <p:menuButton value="..."
                                                  rendered="#{teacherCourseLoadCtrl.model.enableLoadEditing and !teacherCourseLoadCtrl.model.multipleSelection}"
                                    >
                                        <p:menuitem value="Aj. Voeux"
                                                    disabled="#{!teacherCourseLoadCtrl.isAllowedUpdateMineIntents(i.value.assignment.id)}"
                                                    actionListener="#{teacherCourseLoadCtrl.addToMine(i.value.assignment.id)}"
                                                    update=":listForm" icon="ui-icon-arrowrefresh-1-w"/>
                                        <p:menuitem value="Supp. Voeux"
                                                    disabled="#{!teacherCourseLoadCtrl.isAllowedUpdateMineIntents(i.value.assignment.id)}"
                                                    actionListener="#{teacherCourseLoadCtrl.removeFromMine(i.value.assignment.id)}"
                                                    update=":listForm" icon="ui-icon-close"/>
                                        <p:separator/>
                                        <p:menuitem value="Affecter"
                                                    disabled="#{!teacherCourseLoadCtrl.isAllowedUpdateMineAssignments(i.value.assignment.id)}"
                                                    actionListener="#{teacherCourseLoadCtrl.doAssign(i.value.assignment.id)}"
                                                    update=":listForm" icon="ui-icon-arrowrefresh-1-w"/>
                                        <p:menuitem value="Supp. Affectation"
                                                    disabled="#{!teacherCourseLoadCtrl.isAllowedUpdateMineAssignments(i.value.assignment.id)}"
                                                    actionListener="#{teacherCourseLoadCtrl.doUnAssign(i.value.assignment.id)}"
                                                    update=":listForm" icon="ui-icon-close"/>
                                    </p:menuButton>

                                </p:column>
                                <p:column headerText="" width="10%">
                                    <h:outputText
                                            value="#{i.academicClass.name}"/>
                                </p:column>
                                <p:column headerText="Module">
                                    <p:commandLink
                                            action="#{teacherCourseLoadCtrl.gotoCourseAssignment(i.value.assignment)}"
                                            value="#{i.value.assignment.coursePlan.name} - #{i.value.assignment.courseType.name}"
                                            styleClass="#{i.value.assigned?'vr-assigned-course':''}"/>
                                </p:column>
                                <p:column headerText="C" width="5%">
                                    <h:outputText
                                            value="#{i.value.assignment.valueC != 0 ? i.value.assignment.valueC : ''}"/>
                                </p:column>
                                <p:column headerText="TD" width="5%">
                                    <h:outputText
                                            value="#{i.value.assignment.valueTD != 0 ? i.value.assignment.valueTD : ''}"/>
                                </p:column>
                                <p:column headerText="TP" width="5%">
                                    <h:outputText
                                            value="#{i.value.assignment.valueTP != 0 ? i.value.assignment.valueTP : ''}"/>
                                </p:column>
                                <p:column headerText="PM" width="5%">
                                    <h:outputText
                                            value="#{i.value.assignment.valuePM != 0 ? i.value.assignment.valuePM  : ''}"/>
                                </p:column>
                                <p:column headerText="Grp" width="5%">
                                    <h:outputText value="#{i.value.assignment.groupCount}"><f:convertNumber
                                            pattern="#0.#"/></h:outputText>
                                </p:column>

                                <p:column headerText="Voeux des autres" width="20%">
                                    <h:outputText value="#{i.intents}"
                                                  styleClass="#{i.value.assigned?'vr-label-valid':'vr-label-invalid'}"
                                    />
                                </p:column>

                            </p:dataTable>
                        </div>
                    </div>
                </ui:repeat>

                <p:separator/>

                <div class="row">
                    <div class="table-responsive">
                        <h1>Autres modules</h1>

                        <p:dataTable var="i" value="#{teacherCourseLoadCtrl.model.others}"
                                     class="table table-bordered table-hover"
                                     paginatorAlwaysVisible="false"
                                     paginator="true"
                                     paginatorPosition="bottom"
                                     rows="1000"
                                     paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                     rowsPerPageTemplate="1000,2000,5000,1000"
                                     widgetVar="othersTable"
                                     emptyMessage="Aucune charge"
                        >
                            <p:column style="padding: 0;" styleClass="ui-widget-header" headerText="" width="5%">
                                <f:facet name="header">
                                    <p:menuButton value="..."
                                                  rendered="#{teacherCourseLoadCtrl.model.enableLoadEditing and teacherCourseLoadCtrl.model.multipleSelection}"
                                    >
                                        <p:menuitem
                                                rendered="#{teacherCourseLoadCtrl.model.currentTeacher ne null}"
                                                value="Aj. Voeux à #{teacherCourseLoadCtrl.model.currentTeacher.contact.firstName}"
                                                actionListener="#{teacherCourseLoadCtrl.addToMineSelected()}"
                                                update=":listForm" icon="ui-icon-arrowrefresh-1-w"/>
                                        <p:menuitem value="Supp. tous les Voeux"
                                                    actionListener="#{teacherCourseLoadCtrl.removeAllIntentsSelected()}"
                                                    update=":listForm" icon="ui-icon-arrowrefresh-1-w"/>
                                        <p:separator/>
                                        <p:menuitem
                                                rendered="#{teacherCourseLoadCtrl.model.currentTeacher ne null}"
                                                value="Affecter à #{teacherCourseLoadCtrl.model.currentTeacher.contact.firstName}"
                                                actionListener="#{teacherCourseLoadCtrl.doAssignSelected()}"
                                                update=":listForm" icon="ui-icon-arrowrefresh-1-w"/>
                                        <p:menuitem value="Confirmer Aff."
                                                    actionListener="#{teacherCourseLoadCtrl.doAssignByIntentSelected()}"
                                                    update=":listForm" icon="ui-icon-arrowrefresh-1-w"/>
                                        <p:menuitem value="Supp. Affectation"
                                                    actionListener="#{teacherCourseLoadCtrl.doUnAssignSelected()}"
                                                    update=":listForm" icon="ui-icon-arrowrefresh-1-w"/>
                                    </p:menuButton>
                                </f:facet>
                                <p:selectBooleanCheckbox
                                        style="margin-left: 10px;"
                                        rendered="#{teacherCourseLoadCtrl.model.enableLoadEditing and teacherCourseLoadCtrl.model.multipleSelection}"
                                        value="#{i.selected}"/>
                                <p:menuButton value="..."
                                              rendered="#{teacherCourseLoadCtrl.model.currentTeacher ne null and teacherCourseLoadCtrl.model.enableLoadEditing and ! teacherCourseLoadCtrl.model.multipleSelection}"
                                >
                                    <p:menuitem
                                            rendered="#{teacherCourseLoadCtrl.model.currentTeacher ne null}"
                                            value="Aj. Voeux à #{teacherCourseLoadCtrl.model.currentTeacher.contact.firstName}"
                                            disabled="#{!teacherCourseLoadCtrl.isAllowedUpdateMineIntents(i.value.assignment.id) or (teacherCourseLoadCtrl.model.currentTeacher eq null)}"
                                            actionListener="#{teacherCourseLoadCtrl.addToMine(i.value.assignment.id)}"
                                            update=":listForm" icon="ui-icon-arrowrefresh-1-w"/>
                                    <p:menuitem value="Supp. tous les Voeux"
                                                disabled="#{!teacherCourseLoadCtrl.isAllowedUpdateMineIntents(i.value.assignment.id)}"
                                                actionListener="#{teacherCourseLoadCtrl.removeAllIntents(i.value.assignment.id)}"
                                                update=":listForm" icon="ui-icon-arrowrefresh-1-w"/>
                                    <p:separator/>
                                    <p:menuitem
                                            rendered="#{teacherCourseLoadCtrl.model.currentTeacher ne null}"
                                            value="Affecter à #{teacherCourseLoadCtrl.model.currentTeacher.contact.firstName}"
                                            disabled="#{!teacherCourseLoadCtrl.isAllowedUpdateMineAssignments(i.value.assignment.id) or (teacherCourseLoadCtrl.model.currentTeacher eq null)}"
                                            actionListener="#{teacherCourseLoadCtrl.doAssign(i.value.assignment.id)}"
                                            update=":listForm" icon="ui-icon-arrowrefresh-1-w"/>
                                    <p:menuitem value="Confirmer Aff."
                                                disabled="#{!teacherCourseLoadCtrl.isAllowedUpdateMineAssignments(i.value.assignment.id)}"
                                                actionListener="#{teacherCourseLoadCtrl.doAssignByIntent(i.value.assignment.id)}"
                                                update=":listForm" icon="ui-icon-arrowrefresh-1-w"/>
                                    <p:menuitem value="Supp. Affectation"
                                                disabled="#{!teacherCourseLoadCtrl.isAllowedUpdateMineAssignments(i.value.assignment.id)}"
                                                actionListener="#{teacherCourseLoadCtrl.doUnAssign(i.value.assignment.id)}"
                                                update=":listForm" icon="ui-icon-arrowrefresh-1-w"/>
                                </p:menuButton>
                            </p:column>
                            <p:column headerText="" width="10%">
                                <h:outputText value="#{i.value.assignment.coursePlan.courseLevel.semester.name}"/>
                            </p:column>
                            <p:column headerText="" width="10%">
                                <h:outputText value="#{i.academicClass.name}"/>
                            </p:column>
                            <p:column headerText="Module" filterBy="#{i.value.assignment.coursePlan.name}">
                                <p:commandLink
                                        action="#{teacherCourseLoadCtrl.gotoCourseAssignment(i.value.assignment)}"
                                        styleClass="#{i.value.assigned?'vr-assigned-course':''}"
                                        value="#{i.value.assignment.coursePlan.name} - #{i.value.assignment.courseType.name}"/>
                            </p:column>
                            <p:column headerText="C" width="5%">
                                <h:outputText
                                        value="#{i.value.assignment.valueC != 0 ? i.value.assignment.valueC : ''}"/>
                            </p:column>
                            <p:column headerText="TD" width="5%">
                                <h:outputText
                                        value="#{i.value.assignment.valueTD !=0 ? i.value.assignment.valueTD : ''}"/>
                            </p:column>
                            <p:column headerText="TP" width="5%">
                                <h:outputText
                                        value="#{i.value.assignment.valueTP !=0 ? i.value.assignment.valueTP : ''}"/>
                            </p:column>
                            <p:column headerText="PM" width="5%">
                                <h:outputText
                                        value="#{i.value.assignment.valuePM != 0 ? i.value.assignment.valuePM : ''}"/>
                            </p:column>
                            <p:column headerText="Grp" width="5%">
                                <h:outputText value="#{i.value.assignment.groupCount}"><f:convertNumber
                                        pattern="#0.#"/></h:outputText>
                            </p:column>

                            <p:column headerText="Voeux" width="20%">
                                <h:outputText value="#{i.intents}"
                                              styleClass="#{i.value.assigned?'vr-label-valid':'vr-label-invalid'}"/>
                            </p:column>

                            <f:facet name="footer">
                                <p:outputLabel value="Total #{teacherCourseLoadCtrl.model.others.size()}"/>
                            </f:facet>
                        </p:dataTable>
                    </div>
                </div>

            </h:form>


        </ui:define>


    </ui:composition>


</h:body>

</html>
