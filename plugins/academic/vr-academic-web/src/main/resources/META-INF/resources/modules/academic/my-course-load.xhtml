<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this license header, choose License Headers in Project Properties.

and open the template in the editor.
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"

>

<h:head>
</h:head>

<h:body>


    <!--@elvariable id="vr" type="net.vpc.app.vainruling.core.web.Vr"-->
    <!--@elvariable id="myCourseLoadCtrl" type="net.vpc.app.vainruling.plugins.academic.web.load.MyCourseLoadCtrl"-->
    <ui:composition template="#{vr.themePath}/templates/private-template.xhtml">
        <ui:define name="content">
            <h:form id="buttonsForm">
                <p:confirmDialog message="Are you sure, you want to delete ?" header="Initiating deleting process"
                                 widgetVar="confirmationDelete">
                    <p:commandButton value="Yes Sure" onclick="PF('confirmationDelete').hide();
                                processOnDeleteCurrent();"/>
                    <p:commandButton value="Not Yet" onclick="PF('confirmationDelete').hide()" type="button"/>
                </p:confirmDialog>

                <!-- /.row -->
                <!--                    <div class="row">
                                        <p:outputLabel id="buttons">
                                            <p:commandButton value="Rafr." icon="ui-ribbonicon-refresh" styleClass="ui-ribbon-bigbutton vr-icon-aws" ajax="true" actionListener="# {myCourseLoadCtrl.onRefresh}"  update=":listForm"/>
                                        </p:outputLabel>
                                    </div>-->


                <p:fieldset legend="Filtres" toggleable="true" toggleSpeed="500">
                    <div >
                        <p:outputLabel value="Période" styleClass="vr-form-field vr-form-fixed-width-medium"/>
                        <p:selectOneMenu value="#{myCourseLoadCtrl.teacherFilter.model.selectedPeriod}">
                            <p:ajax listener="#{myCourseLoadCtrl.onChangePeriod}" update=":buttonsForm :listForm"/>
                            <f:selectItem itemLabel="Selectionner Période..." itemValue=""/>
                            <f:selectItems value="#{myCourseLoadCtrl.teacherFilter.model.periodItems}"/>
                        </p:selectOneMenu>
                    </div>
                    <div >
                        <p:outputLabel value="Modules" styleClass="vr-form-field vr-form-fixed-width-medium vr-form-indented-child"/>
                        <div class="vr-form-sub-rows">
                            <div class="vr-form-sub-row">
                                <p:selectCheckboxMenu styleClass="vr-form-field"
                                                      value="#{myCourseLoadCtrl.courseFilter.model.selectedSemesters}"
                                                      label="Semestres"
                                                      filter="true" filterMatchMode="startsWith"
                                                      panelStyle="width:250px">
                                    <p:ajax listener="#{myCourseLoadCtrl.onRefreshFiltersChanged}" update=":listForm"/>
                                    <f:selectItems value="#{myCourseLoadCtrl.courseFilter.model.semesterItems}"/>
                                </p:selectCheckboxMenu>
                                <p:selectCheckboxMenu styleClass="vr-form-field"
                                                      value="#{myCourseLoadCtrl.courseFilter.model.selectedCourseTypes}"
                                                      label="Types Modules"
                                                      filter="true" filterMatchMode="startsWith"
                                                      panelStyle="width:250px">
                                    <p:ajax listener="#{myCourseLoadCtrl.onRefreshFiltersChanged}" update=":listForm"/>
                                    <f:selectItems value="#{myCourseLoadCtrl.courseFilter.model.courseTypeItems}"/>
                                </p:selectCheckboxMenu>
                                <p:selectCheckboxMenu styleClass="vr-form-field"
                                                      value="#{myCourseLoadCtrl.courseFilter.model.selectedClasses}"
                                                      label="Classes"
                                                      filter="true" filterMatchMode="startsWith"
                                                      panelStyle="width:250px">
                                    <p:ajax listener="#{myCourseLoadCtrl.onRefreshFiltersChanged}" update=":listForm"/>
                                    <f:selectItems value="#{myCourseLoadCtrl.courseFilter.model.classItems}"/>
                                </p:selectCheckboxMenu>
                            </div>
                            <div class="vr-form-sub-row">
                                <p:selectCheckboxMenu styleClass="vr-form-field"
                                                      value="#{myCourseLoadCtrl.courseFilter.model.selectedProgramTypes}"
                                                      label="Type Formation"
                                                      filter="true" filterMatchMode="startsWith"
                                                      panelStyle="width:250px">
                                    <p:ajax listener="#{myCourseLoadCtrl.onRefreshFiltersChanged}" update=":listForm"/>
                                    <f:selectItems value="#{myCourseLoadCtrl.courseFilter.model.programTypeItems}"/>
                                </p:selectCheckboxMenu>
                                <p:selectCheckboxMenu styleClass="vr-form-field"
                                                      value="#{myCourseLoadCtrl.courseFilter.model.selectedLabels}"
                                                      label="Label"
                                                      filter="true" filterMatchMode="startsWith"
                                                      panelStyle="width:250px">
                                    <p:ajax listener="#{myCourseLoadCtrl.onRefreshFiltersChanged}" update=":listForm"/>
                                    <f:selectItems value="#{myCourseLoadCtrl.courseFilter.model.labelItems}"/>
                                </p:selectCheckboxMenu>
                                <p:selectCheckboxMenu
                                        styleClass="vr-form-field" value="#{myCourseLoadCtrl.courseFilter.model.selectedDeviationGroups}"
                                        label="Groupe Balance"
                                        filter="true" filterMatchMode="startsWith" panelStyle="width:250px">
                                    <p:ajax listener="#{myCourseLoadCtrl.onRefreshFiltersChanged}" update=":listForm"/>
                                    <f:selectItems value="#{myCourseLoadCtrl.courseFilter.model.deviationGroupItems}"/>
                                </p:selectCheckboxMenu>
                            </div>
                            <div class="vr-form-sub-row">
                                <div class="table-responsive">
                                    <p:selectManyCheckbox styleClass="vr-form-field" value="#{myCourseLoadCtrl.courseFilter.model.refreshFilter}"
                                                          layout="grid"
                                                          columns="5">
                                        <p:ajax listener="#{myCourseLoadCtrl.onRefreshFiltersChanged}"
                                                update=":listForm"/>
                                        <f:selectItems
                                                value="#{myCourseLoadCtrl.teacherFilter.model.refreshFilterItems}"/>
                                    </p:selectManyCheckbox>
                                </div>
                            </div>
                            <div class="vr-form-sub-row">
                                <p:selectManyCheckbox styleClass="vr-form-field" id="basic" value="#{myCourseLoadCtrl.model.othersFilters}" layout="grid"
                                                      columns="3">
                                    <p:ajax listener="#{myCourseLoadCtrl.onOthersFiltersChanged}" update=":listForm"/>
                                    <f:selectItems value="#{myCourseLoadCtrl.model.filterSelectItems}"/>
                                </p:selectManyCheckbox>
                            </div>
                        </div>
                    </div>
                </p:fieldset>
            </h:form>
            <h:form id="listForm">

                <div class="row">
                    <div class="table-responsive">
                        <h1><p:outputLabel style="font-weight: bold"
                                           value="#{myCourseLoadCtrl.model.currentTeacher.contact.fullName} - #{myCourseLoadCtrl.model.stat.teacher.degree.name} - #{myCourseLoadCtrl.model.stat.teacher.situation.name}"/>
                        </h1>
                        <p:panelGrid>
                            <p:row>
                                <p:column styleClass="ui-widget-header"><p:outputLabel value=""/></p:column>
                                <p:column styleClass="ui-widget-header"><p:outputLabel value="Semaines"/></p:column>
                                <p:column styleClass="ui-widget-header"><p:outputLabel value="C"/></p:column>
                                <p:column styleClass="ui-widget-header"><p:outputLabel value="TD"/></p:column>
                                <p:column styleClass="ui-widget-header"><p:outputLabel value="TP+PM"/></p:column>
                                <p:column styleClass="ui-widget-header"><p:outputLabel value="Total Charge"/></p:column>
                                <p:column styleClass="ui-widget-header"><p:outputLabel
                                        value="Total Charge / Sem"/></p:column>
                                <p:column styleClass="ui-widget-header"><p:outputLabel
                                        value="Bilan H.Supp."/></p:column>
                                <p:column styleClass="ui-widget-header"><p:outputLabel
                                        value="Balance"/></p:column>
                                <p:column styleClass="ui-widget-header" style="width: 100px"><p:outputLabel
                                        value=""/></p:column>
                            </p:row>
                            <p:row>
                                <p:column styleClass="ui-widget-header"><p:outputLabel
                                        value="Charge Annuelle"/></p:column>
                                <p:column><p:outputLabel value=""/></p:column>
                                <p:column><p:outputLabel value="#{myCourseLoadCtrl.model.stat.value.c}"><f:convertNumber
                                        pattern="#0.00"/></p:outputLabel></p:column>
                                <p:column><p:outputLabel
                                        value="#{myCourseLoadCtrl.model.stat.value.td}"><f:convertNumber
                                        pattern="#0.00"/></p:outputLabel></p:column>
                                <p:column><p:outputLabel
                                        value="#{myCourseLoadCtrl.model.stat.value.tppm}"><f:convertNumber
                                        pattern="#0.00"/></p:outputLabel></p:column>
                                <p:column><p:outputLabel
                                        value="#{myCourseLoadCtrl.model.stat.value.equiv}"><f:convertNumber
                                        pattern="#0.00"/></p:outputLabel></p:column>
                                <p:column><p:outputLabel
                                        value="#{myCourseLoadCtrl.model.stat.valueWeek.equiv}"><f:convertNumber
                                        pattern="#0.00"/></p:outputLabel></p:column>
                                <p:column><p:outputLabel
                                        value="#{myCourseLoadCtrl.model.stat.extraWeek.equiv}"><f:convertNumber
                                        pattern="#0.00"/></p:outputLabel></p:column>
                                <p:column>
                                    <p:outputLabel
                                        value="#{myCourseLoadCtrl.model.stat.deviation}"><f:convertNumber
                                        pattern="#0.00%"/></p:outputLabel>
                                    <h:outputText value=" / #{myCourseLoadCtrl.model.stat.population.size}"/>
                                </p:column>
                                <p:column>
                                    <div class="vr-progress-container" style="width: 100%;">
                                        <div class="#{myCourseLoadCtrl.model.stat.deviationLabel}"
                                             style="width:#{vr.frame(vr.abs(myCourseLoadCtrl.model.stat.deviation),0,1)*100}%">

                                        </div>
                                    </div>
                                </p:column>
                            </p:row>
                            <p:row>
                                <p:column styleClass="ui-widget-header"><p:outputLabel value="Charge S1"/></p:column>
                                <p:column><p:outputLabel
                                        value="#{myCourseLoadCtrl.model.stat.semestrialLoad[0].weeksLoad}"><f:convertNumber
                                        pattern="#0.#"/></p:outputLabel></p:column>
                                <p:column><p:outputLabel
                                        value="#{myCourseLoadCtrl.model.stat.semesters[0].value.c}"><f:convertNumber
                                        pattern="#0.00"/></p:outputLabel></p:column>
                                <p:column><p:outputLabel
                                        value="#{myCourseLoadCtrl.model.stat.semesters[0].value.td}"><f:convertNumber
                                        pattern="#0.00"/></p:outputLabel></p:column>
                                <p:column><p:outputLabel value="#{myCourseLoadCtrl.model.stat.semesters[0].value.tppm}"><f:convertNumber
                                        pattern="#0.00"/></p:outputLabel></p:column>
                                <p:column><p:outputLabel
                                        value="#{myCourseLoadCtrl.model.stat.semesters[0].value.equiv}"><f:convertNumber
                                        pattern="#0.00"/></p:outputLabel></p:column>
                                <p:column><p:outputLabel
                                        value="#{myCourseLoadCtrl.model.stat.semesters[0].valueWeek.equiv}"><f:convertNumber
                                        pattern="#0.00"/></p:outputLabel></p:column>
                                <p:column><p:outputLabel
                                        value="#{myCourseLoadCtrl.model.stat.semesters[0].extraWeek.equiv}"><f:convertNumber
                                        pattern="#0.00"/></p:outputLabel>
                                </p:column>
                                <p:column>
                                    <p:outputLabel
                                            value="#{myCourseLoadCtrl.model.stat.semesters[0].deviation}"><f:convertNumber
                                            pattern="#0.00%"/></p:outputLabel>
                                    <h:outputText value=" / #{myCourseLoadCtrl.model.stat.semesters[0].population.size}"/>
                                </p:column>
                                <p:column>
                                    <div class="vr-progress-container" style="width: 100%;">
                                        <div class="#{myCourseLoadCtrl.model.stat.semesters[0].deviationLabel}"
                                             style="width:#{vr.frame(vr.abs(myCourseLoadCtrl.model.stat.semesters[0].deviation),0,1)*100}%">

                                        </div>
                                    </div>
                                </p:column>
                            </p:row>
                            <p:row>
                                <p:column styleClass="ui-widget-header"><p:outputLabel value="Charge S2"/></p:column>
                                <p:column><p:outputLabel
                                        value="#{myCourseLoadCtrl.model.stat.semestrialLoad[1].weeksLoad}"><f:convertNumber
                                        pattern="#0.#"/></p:outputLabel></p:column>
                                <p:column><p:outputLabel
                                        value="#{myCourseLoadCtrl.model.stat.semesters[1].value.c}"><f:convertNumber
                                        pattern="#0.00"/></p:outputLabel></p:column>
                                <p:column><p:outputLabel
                                        value="#{myCourseLoadCtrl.model.stat.semesters[1].value.td}"><f:convertNumber
                                        pattern="#0.00"/></p:outputLabel></p:column>
                                <p:column><p:outputLabel value="#{myCourseLoadCtrl.model.stat.semesters[1].value.tppm}"><f:convertNumber
                                        pattern="#0.00"/></p:outputLabel></p:column>
                                <p:column><p:outputLabel
                                        value="#{myCourseLoadCtrl.model.stat.semesters[1].value.equiv}"><f:convertNumber
                                        pattern="#0.00"/></p:outputLabel></p:column>
                                <p:column><p:outputLabel
                                        value="#{myCourseLoadCtrl.model.stat.semesters[1].valueWeek.equiv}"><f:convertNumber
                                        pattern="#0.00"/></p:outputLabel></p:column>
                                <p:column><p:outputLabel
                                        value="#{myCourseLoadCtrl.model.stat.semesters[1].extraWeek.equiv}"><f:convertNumber
                                        pattern="#0.00"/></p:outputLabel></p:column>
                                <p:column>
                                    <p:outputLabel
                                            value="#{myCourseLoadCtrl.model.stat.semesters[1].deviation}"><f:convertNumber
                                            pattern="#0.00%"/></p:outputLabel>
                                    <h:outputText value=" / #{myCourseLoadCtrl.model.stat.semesters[1].population.size}"/>
                                </p:column>
                                <p:column>
                                    <div class="vr-progress-container" style="width: 100%;">
                                        <div class="#{myCourseLoadCtrl.model.stat.semesters[1].deviationLabel}"
                                             style="width:#{vr.frame(vr.abs(myCourseLoadCtrl.model.stat.semesters[1].deviation),0,1)*100}%">

                                        </div>
                                    </div>
                                </p:column>
                            </p:row>
                        </p:panelGrid>
                    </div>
                </div>

                <div class="row">
                    <div class="table-responsive">
                        <h1>Semestre 1</h1>
                        <p:dataTable var="i" value="#{myCourseLoadCtrl.model.mineS1}"
                                     class="table table-bordered table-hover"
                                     paginatorAlwaysVisible="false"
                                     paginator="true"
                                     paginatorPosition="bottom"
                                     rows="20"
                                     paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                     rowsPerPageTemplate="10,20,50"
                                     emptyMessage="Aucune charge"
                        >
                            <p:column styleClass="ui-widget-header" headerText="" width="5%">
                                <p:commandButton
                                        rendered="#{myCourseLoadCtrl.model.enableLoadEditing}"
                                        disabled="#{i.assigned}"
                                        value="-"
                                        actionListener="#{myCourseLoadCtrl.removeFromMine(i.assignment.id)}"
                                        update=":listForm" title="Clickez ici pour supprimer le voeux"/>
                            </p:column>
                            <p:column headerText="" width="10%">
                                <h:outputText value="#{i.assignment.coursePlan.courseLevel.academicClass.name}"/>
                            </p:column>
                            <p:column headerText="Module">
                                <h:outputText styleClass="#{i.assigned?'vr-assigned-course':''}"
                                              value="#{i.assignment.coursePlan.name} - #{i.assignment.courseType.name}"/>
                            </p:column>
                            <p:column headerText="C" width="5%">
                                <h:outputText value="#{i.assignment.valueC != 0 ? i.assignment.valueC : ''}"/>
                            </p:column>
                            <p:column headerText="TD" width="5%">
                                <h:outputText value="#{i.assignment.valueTD != 0 ? i.assignment.valueTD : ''}"/>
                            </p:column>
                            <p:column headerText="TP" width="5%">
                                <h:outputText value="#{i.assignment.valueTP != 0 ? i.assignment.valueTP : ''}"/>
                            </p:column>
                            <p:column headerText="PM" width="5%">
                                <h:outputText value="#{i.assignment.valuePM != 0 ? i.assignment.valuePM : ''}"/>
                            </p:column>
                            <p:column headerText="Grp" width="5%">
                                <h:outputText value="#{i.assignment.groupCount}"><f:convertNumber
                                        pattern="#0.#"/></h:outputText>
                            </p:column>

                            <p:column headerText="Voeux des autres" width="20%">
                                <h:outputText value="#{i.intents}"/>
                            </p:column>

                        </p:dataTable>
                    </div>

                </div>

                <div class="row">
                    <div class="table-responsive">
                        <h1>Semestre 2</h1>
                        <p:dataTable var="i" value="#{myCourseLoadCtrl.model.mineS2}"
                                     class="table table-bordered table-hover"
                                     paginatorAlwaysVisible="false"
                                     paginator="true"
                                     paginatorPosition="bottom"
                                     rows="20"
                                     paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                     rowsPerPageTemplate="10,20,50"
                                     emptyMessage="Aucune charge"
                        >
                            <p:column styleClass="ui-widget-header" headerText="" width="5%">
                                <p:commandButton rendered="#{myCourseLoadCtrl.model.enableLoadEditing}"
                                                 disabled="#{i.assigned}" value="-"
                                                 actionListener="#{myCourseLoadCtrl.removeFromMine(i.assignment.id)}"
                                                 update=":listForm" title="Clickez ici pour supprimer le voeux"/>
                            </p:column>
                            <p:column headerText="" width="10%">
                                <h:outputText
                                        value="#{i.assignment.coursePlan.courseLevel.academicClass.program.name}-#{i.assignment.coursePlan.courseLevel.academicClass.name}"/>
                            </p:column>
                            <p:column headerText="Module">
                                <h:outputText styleClass="#{i.assigned?'vr-assigned-course':''}"
                                              value="#{i.assignment.coursePlan.name} - #{i.assignment.courseType.name}"/>
                            </p:column>
                            <p:column headerText="C" width="5%">
                                <h:outputText value="#{i.assignment.valueC != 0 ? i.assignment.valueC : ''}"/>
                            </p:column>
                            <p:column headerText="TD" width="5%">
                                <h:outputText value="#{i.assignment.valueTD != 0 ? i.assignment.valueTD : ''}"/>
                            </p:column>
                            <p:column headerText="TP" width="5%">
                                <h:outputText value="#{i.assignment.valueTP != 0 ? i.assignment.valueTP : ''}"/>
                            </p:column>
                            <p:column headerText="PM" width="5%">
                                <h:outputText value="#{i.assignment.valuePM != 0 ? i.assignment.valuePM  : ''}"/>
                            </p:column>
                            <p:column headerText="Grp" width="5%">
                                <h:outputText value="#{i.assignment.groupCount}"><f:convertNumber
                                        pattern="#0.#"/></h:outputText>
                            </p:column>

                            <p:column headerText="Voeux des autres" width="20%">
                                <h:outputText value="#{i.intents}"/>
                            </p:column>

                        </p:dataTable>
                    </div>
                </div>


                <p:separator/>

                <div class="row">
                    <div class="table-responsive">
                        <h1>Autres modules</h1>
                        <p:dataTable var="i" value="#{myCourseLoadCtrl.model.others}"
                                     class="table table-bordered table-hover"
                                     paginatorAlwaysVisible="false"
                                     paginator="true"
                                     paginatorPosition="bottom"
                                     rows="200"
                                     paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                     rowsPerPageTemplate="20,50,100,200,1000"
                                     emptyMessage="Aucune charge"
                        >
                            <p:column styleClass="ui-widget-header" headerText="" width="5%">
                                <p:commandButton
                                        rendered="#{myCourseLoadCtrl.model.enableLoadEditing}"
                                        disabled="#{i.assigned}"
                                        value="+"
                                        actionListener="#{myCourseLoadCtrl.addToMine(i.assignment.id)}"
                                        update=":listForm" title="Clickez ici pour exprimez votre voeux"/>
                            </p:column>
                            <p:column headerText="" width="10%">
                                <h:outputText value="#{i.assignment.coursePlan.courseLevel.semester.name}"/>
                            </p:column>
                            <p:column headerText="" width="10%">
                                <h:outputText
                                        value="#{i.assignment.coursePlan.courseLevel.academicClass.program.name}-#{i.assignment.coursePlan.courseLevel.academicClass.name}"/>
                            </p:column>
                            <p:column headerText="Module" filterBy="#{i.assignment.coursePlan.name}">
                                <h:outputText styleClass="#{i.assigned?'vr-assigned-course':''}"
                                              value="#{i.assignment.coursePlan.name} - #{i.assignment.courseType.name}"/>
                            </p:column>
                            <p:column headerText="C" width="5%">
                                <h:outputText value="#{i.assignment.valueC != 0 ? i.assignment.valueC : ''}"/>
                            </p:column>
                            <p:column headerText="TD" width="5%">
                                <h:outputText value="#{i.assignment.valueTD !=0 ? i.assignment.valueTD : ''}"/>
                            </p:column>
                            <p:column headerText="TP" width="5%">
                                <h:outputText value="#{i.assignment.valueTP !=0 ? i.assignment.valueTP : ''}"/>
                            </p:column>
                            <p:column headerText="PM" width="5%">
                                <h:outputText value="#{i.assignment.valuePM != 0 ? i.assignment.valuePM : ''}"/>
                            </p:column>
                            <p:column headerText="Grp" width="5%">
                                <h:outputText value="#{i.assignment.groupCount}"><f:convertNumber
                                        pattern="#0.#"/></h:outputText>
                            </p:column>

                            <p:column headerText="Voeux" width="20%">
                                <h:outputText value="#{i.intents}"/>
                            </p:column>

                            <f:facet name="footer">
                                <p:outputLabel value="Total #{myCourseLoadCtrl.model.others.size()}"/>
                            </f:facet>
                        </p:dataTable>
                    </div>
                </div>

            </h:form>


        </ui:define>


    </ui:composition>


</h:body>

</html>
